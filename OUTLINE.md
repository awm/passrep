# Outline of Behaviour #

- User's private keys are derived from user's password
- Individual entries encrypted using user's private encryption key
- Access control settings determine read, write, and delegate access to individual entries and groups of entries
- Change procedure:
    - User changes local entry
    - Change notification is encrypted for each user with read access to that entry using secret calculated from modifier's private signing key and reader's public signing key
    - Encrypted change notification pushed on to each user's change queue
    - When user logs in, queued changes are replayed into their local entries
- Access to a particular entry must be granted after an account is created by a user who already has delegate access to the entry
- New user accounts start out with no entries
- The first user must be set up when initializing the database
- User password change procedure:
    - User's old key is temporarily cached
    - User's new key is calculated
    - Each stored entry in the database is evaluated to see if it was encrypted by this user
        - Entries that match are decrypted using the cached key and then re-encrypted using the new one
    - Each queued change in the database is evaluated to see if it was encrypted by this user
        - Entries that match are decrypted using the cached key and then re-encrypted using the new one
    - Each signed permission in the database is evaluated to see if it was signed by this user
        - Entries that match are re-signed using the new key
    - The cached old key is discarded
 - If a user is deleted while other users have pending permission grants from him, the permission grants are re-written to be from the user that granted delegate permission to the deleted user
